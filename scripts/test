#!/usr/bin/env bash
# Test script for PostGIS plugin
# Requires TEST_DATABASE_URL environment variable to be set

set -e

if [ -z "$TEST_DATABASE_URL" ]; then
  echo "Error: TEST_DATABASE_URL environment variable is not set"
  echo "Please set it to your PostgreSQL connection string, e.g.:"
  echo "  export TEST_DATABASE_URL=postgres://postgres:test@localhost:5432/postgres"
  exit 1
fi

# Load test schema
echo "Loading test schema..."
psql "$TEST_DATABASE_URL" -f __tests__/fixtures/schema.sql

# Run Jest tests
echo "Running tests..."
npx jest "$@"

